Model already exists: ../sfd-main/src/cifar10/edm-cifar10-32x32-uncond-vp.pkl
Loading the pre-trained diffusion model from "../sfd-main/src/cifar10/edm-cifar10-32x32-uncond-vp.pkl"...
/home/zeus/miniconda3/envs/cloudspace/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:4631: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user. 
  warnings.warn(  # warn only once
Total parameters in U-Net:      60396419
Setting up optimizer...
Training for 1 kimg...

====Printng tsteps shape=======
torch.Size([13])
====Printed=======
Teacher trajectory length: 13
Teacher trajectory shape: inside get teacher torch.Size([13, 128, 3, 32, 32])
======Printing Teacher traj shape====
num_acc_rounds 1
1
torch.Size([13, 128, 3, 32, 32])
======Printed Teacher traj shape======
Student tsteps length: 5
Start student sampling with step_idx:  tensor([0])
Student tsteps: tensor([80.0000, 51.1571, 31.7298, 19.0034, 10.9293], device='cuda:0')
Student start index: tensor([0])
for now denoised is of shape [B, C, H, W] we will copy it to [B, num_future_steps, C, H, W]
torch.Size([128, 3, 32, 32])   shape for denoised_multistep
torch.Size([128, 4, 3, 32, 32])   shape for denoised_multistep after repeat
Student trajectory shape: torch.Size([5, 128, 3, 32, 32])
teacher_out shape: in student loss  torch.Size([4, 128, 3, 32, 32])
[rank0]: Traceback (most recent call last):
[rank0]:   File "/teamspace/studios/this_studio/sfd-main/train.py", line 155, in <module>
[rank0]:     main()
[rank0]:   File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.9/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:   File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.9/site-packages/click/core.py", line 1082, in main
[rank0]:     rv = self.invoke(ctx)
[rank0]:   File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.9/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:   File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.9/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:   File "/teamspace/studios/this_studio/sfd-main/train.py", line 150, in main
[rank0]:     training_loop.training_loop(**c)
[rank0]:   File "/teamspace/studios/this_studio/sfd-main/training/training_loop.py", line 292, in training_loop
[rank0]:     loss, stu_out = loss_fn(net=ddp, tensor_in=latents[round_idx], labels=labels[round_idx], step_idx=step_idx, teacher_out=teacher_traj[round_idx][start:end])                        
[rank0]:   File "/teamspace/studios/this_studio/sfd-main/training/loss.py", line 97, in __call__
[rank0]:     loss = (student_out - teacher_out).abs()  # model can prioritize any one loss over the otherNOTE
[rank0]: RuntimeError: The size of tensor a (5) must match the size of tensor b (4) at non-singleton dimension 0
